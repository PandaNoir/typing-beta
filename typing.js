$(function(){$.getJSON("./tango.json",null,function(b){function c(a){return 0|Math.random()*a}var d=function(a){q.html(a[0]);r.html(a[1]);a=a[1];for(var b=0,d=a.length,c="";b<d;){var e=a.charAt(b+1)||"",c=0!==b?c+"<div>":c+"<div class='now'>",c=c+getRoman(a,b)[0].replace(/ /g,"&nbsp;"),c=c+"</div>";isSmallChar(e)||"\u3063"===a.charAt(b)?(b+=2,isSmallChar(a.charAt(b))&&(b+=1)):b+=1}p.is(".closed")?p.html(c+'<div id="close">\u25bc</div>').addClass("closed"):p.html(c+'<div id="close">\u25b2</div>').removeClass("closed")},
e=function(b,d,c){d=getRoman(b,d)[a.route[0]||0];b=d.slice(0,c).replace(/ /g,"&nbsp;");c=d.slice(c).replace(/ /g,"&nbsp;");p.find("div.now").html('<span class="red">'+b+"</span>"+c)};b.bsearch=function(a){for(var b=0,d=this.length,c;b<=d;)if(c=0|(b+d)/2,this[c][0]>a&&(d=c-1),this[c][0]<a&&(b=c+1),this[c][0]===a)return c;return-1};var f=!1,a={strPos:0,pos:0,now:c(b.length),route:UNDECIDED},k=0,l=0,g=!1,q=$("#kanji"),r=$("#hiragana"),v=$("#miss"),w=$("#collect"),p=$("#roman"),t=0;q.text("\u30b9\u30da\u30fc\u30b9\u30ad\u30fc\u3067\u30b9\u30bf\u30fc\u30c8");
var u=function(q){if(32===q.keyCode)return g=!0,$(window).off("keydown",u),d(b[a.now]),setInterval(function(){t=0|t+100;var a=l/(t/1E3),a=Math.round(100*a)/100;$("#typingSpeed").text(a+"\u56de/\u79d2")},100),p.on("click","#close",function(){p.is(".closed")?($("#close").text("\u25b2"),p.removeClass("closed")):($("#close").text("\u25bc"),p.addClass("closed"))}),$(window).on("keydown",function(h){var g=b[a.now][1],m=g.charAt(a.strPos+1);if(16!==h.which&&91!==h.which&&!h.ctrlKey&&!h.metaKey){var m=h.which,
n="";h.shiftKey?49===m?n="!":53===m?n="%":54===m?n="&":56===m?n="(":57===m?n=")":219===m?n="":221===m&&(n=""):32===m?n=" ":186===m?n=":":188===m?n=",":189===m?n="-":190===m?n=".":191===m&&(n="\u30fb");key=n;""===key&&h.shiftKey&&(key=String.fromCharCode(h.keyCode).toUpperCase());""!==key||h.shiftKey||(key=String.fromCharCode(h.keyCode).toLowerCase());h=moji(b[a.now][1],a.strPos,a.pos,key,a.route);if(!1===h.ok)k+=1,v.text("\u30df\u30b9:"+k);else return l+=1,w.text("\u6253\u9375\u6570:"+l),a.pos+=1,
a.route=h.route,"end"===h.ok&&(e(g,a.strPos,a.pos),m=g.charAt(a.strPos+1),p.find("div.now").removeClass("now").next().addClass("now"),h=g.charAt(a.strPos),isSmallChar(m)||"\u3063"===h?(a.strPos+=2,isSmallChar(g.charAt(a.strPos))&&(a.strPos+=1)):a.strPos+=1,a.strPos>=g.length&&(f||(a.now=c(b.length)),a.strPos=0,d(b[a.now])),a.route=UNDECIDED,a.pos=0),e(b[a.now][1],a.strPos,a.pos),g=r.text().slice(0,a.strPos),h=r.text().slice(a.strPos),r.html('<span class="red">'+g+"</span>"+h),!1}}),!1};$(window).on("keydown",
function(e){if((e.ctrlKery&&!e.metaKey||!e.ctrlKey&&e.metaKey)&&89===e.keyCode&&e.shiftKey)return(f=!f)?($("body").addClass("TheYukari"),a.now=b.bsearch("\u7d50\u6708\u3086\u304b\u308a")):($("body").removeClass("TheYukari"),a.now=c(b.length)),g&&d(b[a.now]),a.route=UNDECIDED,a.pos=0,!1}).on("keydown",u)}).error(function(b,c,d){console.log("\u30a8\u30e9\u30fc:"+c);console.log("\u30c6\u30ad\u30b9\u30c8:"+b.responseText)})});var UNDECIDED=42,romanTable={0:"0",1:"1",2:"2",3:"3",4:"4",5:"5",6:"6",7:"7",8:"8",9:"9","\u3042":"a","\u3044":"i","\u3046":"u","\u3048":"e","\u304a":"o","\u304b":"ka","\u304d":"ki","\u304f":"ku","\u3051":"ke","\u3053":"ko","\u3055":"sa","\u3057":"si,shi","\u3059":"su","\u305b":"se","\u305d":"so","\u305f":"ta","\u3061":"ti,chi","\u3064":"tu,tsu","\u3066":"te","\u3068":"to","\u306a":"na","\u306b":"ni","\u306c":"nu","\u306d":"ne","\u306e":"no","\u306f":"ha","\u3072":"hi","\u3075":"hu,fu","\u3078":"he",
"\u307b":"ho","\u307e":"ma","\u307f":"mi","\u3080":"mu","\u3081":"me","\u3082":"mo","\u3084":"ya","\u3086":"yu","\u3088":"yo","\u3089":"ra","\u308a":"ri","\u308b":"ru","\u308c":"re","\u308d":"ro","\u308f":"wa","\u3092":"wo","\u3093":"nn","\u304c":"ga","\u304e":"gi","\u3050":"gu","\u3052":"ge","\u3054":"go","\u3056":"za","\u3058":"zi,ji","\u305a":"zu","\u305c":"ze","\u305e":"zo","\u3060":"da","\u3062":"di","\u3065":"du","\u3067":"de","\u3069":"do","\u3070":"ba","\u3073":"bi","\u3076":"bu","\u3079":"be",
"\u307c":"bo","\u3071":"pa","\u3074":"pi","\u3077":"pu","\u307a":"pe","\u307d":"po","\u3058\u3083":"ja,zya,jixya,zixya","\u3058\u3085":"ju,zyu,jixyu,zixyu","\u3058\u3047":"je,zye,jixe,zixe","\u3058\u3087":"jo,zyo,jixyo,zixyo","\u3066\u3043":"thi,texi","\u3066\u3047":"the,text","\u3075\u3041":"fa,fuxa,huxa","\u3075\u3043":"fi,fuxi,huxi","\u3075\u3047":"fe,fuxe,huxe","\u3075\u3049":"fo,fuxo,huxo","\u3094\u3041":"va,vuxa","\u3094\u3043":"vi,vuxi","\u3094":"vu","\u3094\u3047":"ve,vuxe","\u3094\u3049":"vo,vuxo",
"\u3046\u3041":"uxa,wya","\u3046\u3043":"wi,uxi,whi","\u3046\u3047":"we,uxe,whe","\u3046\u3049":"uxo,who","\u3050\u3041":"gwa,guxa","\u3050\u3043":"gwi,guxi","\u3050\u3045":"gwu,guxu","\u3050\u3047":"gwe,guxe","\u3050\u3049":"gwo,guxo","\u3064\u3041":"tsa,tuxa,tsuxa","\u3064\u3043":"tsi,tuxi,tsuxi","\u3064\u3047":"tse,tuxe,tsuxe","\u3064\u3049":"tso,tuxo,tsuxo","\u3068\u3041":"twa,toxa","\u3068\u3043":"twi,toxi","\u3068\u3045":"twu,toxu","\u3068\u3047":"twe,toxe","\u3068\u3049":"two,toxo","\u3067\u3043":"dhi,dexi",
"\u3069\u3045":"dwu,doxu","\u30fc":"-","-":"-"," ":" ",",":",",":":":","(":"(",")":")","{":"{","}":"}",".":".","\u30fb":"\u30fb","!":"!",a:"a",A:"A",b:"b",B:"B",c:"c",C:"C",d:"d",D:"D",e:"e",E:"E",f:"f",F:"F",g:"g",G:"G",h:"h",H:"H",i:"i",I:"I",j:"j",J:"J",k:"k",K:"K",l:"l",L:"L",m:"m",M:"M",n:"n",N:"N",o:"o",O:"O",p:"p",P:"P",q:"q",Q:"Q",r:"r",R:"R",s:"s",S:"S",t:"t",T:"T",u:"u",U:"U",v:"v",V:"V",w:"w",W:"W",x:"x",X:"X",y:"y",Y:"Y",z:"z",Z:"Z","&":"&","\u3002":".","%":"%"},consonant={"\u3042":"",
"\u3044":"","\u3046":"","\u3048":"","\u304a":"","\u304b":"k","\u304d":"k","\u304f":"k","\u3051":"k","\u3053":"k","\u3055":"s","\u3057":"s","\u3059":"s","\u305b":"s","\u305d":"s","\u305f":"t","\u3061":"t","\u3064":"t","\u3066":"t","\u3068":"t","\u306a":"n","\u306b":"n","\u306c":"n","\u306d":"n","\u306e":"n","\u306f":"h","\u3072":"h","\u3075":"h","\u3078":"h","\u307b":"h","\u307e":"m","\u307f":"m","\u3080":"m","\u3081":"m","\u3082":"m","\u3084":"y","\u3086":"y","\u3088":"y","\u3089":"r","\u308a":"r",
"\u308b":"r","\u308c":"r","\u308d":"r","\u308f":"w","\u304c":"g","\u304e":"g","\u3050":"g","\u3052":"g","\u3054":"g","\u3056":"z","\u3058":"z,j","\u305a":"z","\u305c":"z","\u305e":"z","\u3060":"d","\u3062":"d","\u3065":"d","\u3067":"d","\u3069":"d","\u3070":"b","\u3073":"b","\u3076":"b","\u3079":"b","\u307c":"b","\u3071":"p","\u3074":"p","\u3077":"p","\u307a":"p","\u307d":"p"},moji=function(b,c,d,e,f){f=f||UNDECIDED;var a=!1,k=[],l=b.charAt(c+1),g=b.charAt(c);if(isSmallChar(l)||"\u3063"===g||"\u3093"===
g||"\u3093"===b.charAt(c-1))b=getRoman(b,c);else if(0<romanTable[g].indexOf(","))b=romanTable[b.charAt(c)].split(",");else return b=getRoman(b,c)[f[0]||0],b.charAt(d)===e&&(a=!0,d===b.length-1&&(a="end")),a?{route:UNDECIDED,ok:a}:{ok:!1};c=0;for(l=b.length;c<l;c+=1)b[c].charAt(d)!==e||!has(f,c)&&f!==UNDECIDED||(a=!0,d===b[c].length-1&&(a="end"),k.push(c));return a?{route:k,ok:a}:{ok:!1}},getRoman=function(b,c){var d=b.charAt(c+1),e=[],f=b.charAt(c),a=function(a,b){var c;"\u3043"===b?c=["yi","ixi"]:
"\u3047"===b?c=["ye","ixe"]:"\u3083"===b?c=["ya","ixya"]:"\u3085"===b?c=["yu","ixyu"]:"\u3087"===b&&(c=["yo","ixyo"]);var d=[];if(romanTable[a+b])d=romanTable[a+b].split(",");else if(-1!==consonant[a].indexOf(","))for(var e=consonant[a].split(","),g=e.length,f=0;f<g;f=0|f+1)d.push(e[f]+c[0]),d.push(e[f]+c[1]);else d=[consonant[a]+c[0],consonant[a]+c[1]];return d};if("\u3063"===f)if(-1!==consonant[d].indexOf(",")||isSmallChar(b.charAt(c+2)))if(e=[],isSmallChar(b.charAt(c+2))){c+=1;d=b.charAt(c+1);
e=a(f,d);--c;for(var d=b.charAt(c+1),k=consonant[d].split(","),l=l=k.length,a=0;a<l;a=0|a+1)for(var d=e.length,g=0;g<d;g=0|g+1)e.push("xtu"+e[g]),e.push("xtsu"+e[g]),e[g]=k[a]+e[g]}else for(k=g=consonant[d].split(","),l=k.length,a=0;a<l;a=0|a+1)e.push(k[a]+k[a]+romanTable[d].slice(-1)),e.push("xtu"+romanTable[d]),e.push("xtsu"+romanTable[d]);else for(var k=romanTable[d].split(","),a=0,l=k.length;a<l;a=0|a+1)e.push(consonant[d]+consonant[d]+romanTable[d].slice(-1)),e.push("xtu"+k[a]),e.push("xtsu"+
k[a]);else e="\u3093"===f?""!==d&&(void 0===consonant[d]||"n"!==consonant[d]&&""!==consonant[d]&&"y"!==consonant[d])?["n"]:["nn"]:isSmallChar(d)?"\u3043"===d||"\u3047"===d||"\u3083"===d||"\u3085"===d||"\u3087"===d?a(f,d):romanTable[f+d].split(","):","!==romanTable[f]?romanTable[f].split(","):romanTable[f];if("\u3093"===b.charAt(c-1)&&"n"!==consonant[f]&&""!==consonant[f])for(e=getRoman(b.slice(c),0),a=0,l=e.length;a<l;a=0|a+1)e.push("n"+e[a]);return e},isSmallChar=function(b){return"\u3041"===b||
"\u3043"===b||"\u3045"===b||"\u3047"===b||"\u3049"===b||"\u3083"===b||"\u3085"===b||"\u3087"===b?!0:!1};function has(b,c){for(var d=0,e=b.length;d<e;d=0|d+1)if(b[d]===c)return!0;return!1}(function(b){"process"in b&&(module.exports={romanTable:romanTable,moji:moji,getRoman:getRoman,isSmallChar:isSmallChar,UNDECIDED:UNDECIDED})})((this||0).self||global);
